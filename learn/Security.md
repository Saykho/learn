# OWASP, XSS, CSRF –∏ Clickjacking ‚Äî —à–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ OWASP

**OWASP (Open Web Application Security Project)** ‚Äî —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è,  
–∫–æ—Ç–æ—Ä–∞—è –ø—É–±–ª–∏–∫—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

–°–∞–º–æ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ ‚Äî **OWASP Top 10**:  
—Å–ø–∏—Å–æ–∫ 10 —Å–∞–º—ã—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç).

–ü—Ä–∏–º–µ—Ä—ã –∏–∑ OWASP Top 10:
- A01: Broken Access Control
- A02: Cryptographic Failures
- A03: Injection (–≤ —Ç.—á. XSS, SQL Injection)
- A05: Security Misconfiguration
- A08: Software and Data Integrity Failures

---

## XSS ‚Äî Cross-Site Scripting

**–ß—Ç–æ —ç—Ç–æ:**  
–£—è–∑–≤–∏–º–æ—Å—Ç—å, –∫–æ–≥–¥–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–≤–æ–π JavaScript-–∫–æ–¥ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É,  
–∏ —ç—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### –ü—Ä–∏–º–µ—Ä
```html
<!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div>
  <p>–û—Ç–∑—ã–≤: <%= userComment %></p>
</div>
```
–ï—Å–ª–∏ userComment = ```<script>alert('XSS!')</script>```, —Ç–æ –±—Ä–∞—É–∑–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç –∫–æ–¥ ‚Üí XSS-–∞—Ç–∞–∫–∞.

### –¢–∏–ø—ã XSS

| –¢–∏–ø | –ì–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è | –ü—Ä–∏–º–µ—Ä |
|-----|------------------|---------|
| **Stored XSS** | –ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Å–æ–æ–±—â–µ–Ω–∏—è) | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î `<script>alert('XSS')</script>`, –∏ —ç—Ç–æ—Ç –∫–æ–¥ –ø–æ—Ç–æ–º –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º |
| **Reflected XSS** | –ö–æ–¥ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ URL –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ | `https://example.com?q=<script>alert('XSS')</script>` |
| **DOM XSS** | –ê—Ç–∞–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å DOM | `element.innerHTML = location.hash` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `document.write()` |
### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è

- **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å (escape)** HTML-–≤–≤–æ–¥ –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π:

```js
function escapeHTML(str) {
  return str.replace(/[&<>"']/g, c =>
    ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[c])
  );
}
```
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã (React, Vue, Angular ‚Äî —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

–ù–µ –≤—Å—Ç–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –≤ innerHTML

–í HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö:
```text
Content-Security-Policy: default-src 'self'
```

## CSRF ‚Äî Cross-Site Request Forgery
**–ß—Ç–æ —ç—Ç–æ**:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –Ω–∞ —Å–∞–π—Ç–µ, –∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –±—Ä–∞—É–∑–µ—Ä
–≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –æ—Ç –µ–≥–æ –∏–º–µ–Ω–∏.
### –ü—Ä–∏–º–µ—Ä
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à—ë–ª –Ω–∞ bank.com

–ù–∞ –¥—Ä—É–≥–æ–º —Å–∞–π—Ç–µ `<img src="https://bank.com/transfer?to=hacker&amount=1000">`

–ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—É–∫–∏ —Å–µ—Å—Å–∏–∏ ‚Üí –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω üò±

### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç CSRF

- **CSRF-—Ç–æ–∫–µ–Ω—ã**
    - –°–µ—Ä–≤–µ—Ä –≤—ã–¥–∞—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    - –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –∫–∞–∂–¥–æ–º POST-–∑–∞–ø—Ä–æ—Å–µ
    - –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

- **SameSite cookies**

```http
Set-Cookie: session=abc123; SameSite=Lax; Secure
```
- **–ü—Ä–æ–≤–µ—Ä—è—Ç—å Origin / Referer –∑–∞–≥–æ–ª–æ–≤–∫–∏**
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CORS —Å –±–µ–ª—ã–º —Å–ø–∏—Å–∫–æ–º –¥–æ–º–µ–Ω–æ–≤**

## Clickjacking
**–ß—Ç–æ —ç—Ç–æ**:
–ê—Ç–∞–∫–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π —Å–∞–π—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–∞—à —Å–∞–π—Ç –≤ `<iframe>`
–∏ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–ª–∏–∫–∞—Ç—å –ø–æ —Å–∫—Ä—ã—Ç—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, ‚Äú–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç‚Äù).
### –ü—Ä–∏–º–µ—Ä
```
<iframe src="https://bank.com/delete-account" style="opacity:0; position:absolute; top:0; left:0;"></iframe>
```
### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è
- **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏:** `X-Frame-Options: DENYX-Frame-Options: DENY` –∏–ª–∏  `Content-Security-Policy: frame-ancestors 'none';`
## –ò—Ç–æ–≥–æ

| –£—è–∑–≤–∏–º–æ—Å—Ç—å     | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                     | –ó–∞—â–∏—Ç–∞                                 |
|----------------|--------------------------------|----------------------------------------|
| **XSS**        | –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ JS-–∫–æ–¥–∞              | —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, CSP                     |
| **CSRF**       | –∑–∞–ø—Ä–æ—Å –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è   | CSRF-—Ç–æ–∫–µ–Ω, SameSite cookie           |
| **Clickjacking** | –æ–±–º–∞–Ω–Ω—ã–π –∫–ª–∏–∫ —á–µ—Ä–µ–∑ iframe   | X-Frame-Options, CSP                   |
| **OWASP**      | –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —ç—Ç–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OWASP Top 10 –∫–∞–∫ —á–µ–∫–ª–∏—Å—Ç |

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∑–∞—â–∏—Ç—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ

### 1. XSS (Cross-Site Scripting)

- –û—Ç–∫—Ä–æ–π DevTools ‚Üí Console
- –ü–æ–ø—Ä–æ–±—É–π –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–µ –≤—Ä–æ–¥–µ `<script>alert('XSS')</script>`
- –ï—Å–ª–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –∑–Ω–∞—á–∏—Ç **–¥–∞–Ω–Ω—ã–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
- –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ **Content-Security-Policy (CSP)** –≤ Network ‚Üí Response Headers

–ü—Ä–∏–º–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞ CSP:
```http
Content-Security-Policy: default-src 'self';
```
### 2. CSRF (Cross-Site Request Forgery)

- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ **CSRF-—Ç–æ–∫–µ–Ω–æ–≤**:
    - –í DevTools ‚Üí Network ‚Üí Request Headers –∏—â–µ–º —Ç–æ–∫–µ–Ω (`X-CSRF-Token`) –≤ POST-–∑–∞–ø—Ä–æ—Å–∞—Ö

- –ü—Ä–æ–≤–µ—Ä—è–µ–º cookie —Ñ–ª–∞–≥ **SameSite**:
    - DevTools ‚Üí Application ‚Üí Cookies ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ `SameSite=Lax` –∏–ª–∏ `Strict`

- –ú–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST-–∑–∞–ø—Ä–æ—Å —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –µ–≥–æ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç
### 3. Clickjacking

- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∑–∞–ø—Ä–µ—â–∞—é—â–∏–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ:
    - DevTools ‚Üí Network ‚Üí Response Headers
    - –ó–∞–≥–æ–ª–æ–≤–∫–∏:

```http
X-Frame-Options: DENY
Content-Security-Policy: frame-ancestors 'none';
```
- –ï—Å–ª–∏ –æ–Ω–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, —Å–∞–π—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–Ω–µ–¥—Ä—ë–Ω –≤ iframe –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Å–∞–π—Ç–µ

